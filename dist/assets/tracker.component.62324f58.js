import{r as o,a9 as k,u as $,b as r,F as S,j as a,$ as V,x as z,S as x,a2 as K,D as H,B as J,ab as Q,A as f,a4 as W,aI as c,h as X,q as Y,M as Z,aJ as ee,aK as te,aL as ae,aM as b,Q as se,aN as ie,n as d}from"./vendor.717f8fec.js";import{b as oe,I as ne,C as re,a as P,P as w,e as C}from"./index.4d0a637e.js";import{O as le}from"./index.d2755a32.js";import{U as ce}from"./index.82e5fdd6.js";import{T as de}from"./table-search.component.ce6b9b32.js";import{R as ue}from"./download-button.component.d6719b73.js";import"./new-button.component.11622eb0.js";const _e=()=>{const[I,v]=o.exports.useState([]),[O,T]=o.exports.useState({}),[g,y]=o.exports.useState(1),[E,u]=o.exports.useState(!1),[p,A]=o.exports.useState(""),[L,_]=o.exports.useState(!1),[m]=k.useForm();oe();const R=[{title:"Project Title",dataIndex:"title",key:"title"},{title:"Office",dataIndex:"office",key:"office_id",render:(e,t)=>{var s,i;return a(le,{office:t.office,children:a(f,{style:{backgroundColor:(s=t.office)==null?void 0:s.color},children:(i=t.office)==null?void 0:i.acronym})})},align:"center"},{title:"Issues",dataIndex:"issues_count",key:"issues_count",align:"center",render:(e,t)=>t.issues_count>0?t.issues_count:a(W,{style:{color:re.green}})},{title:"PIPS",dataIndex:"pips_status",key:"pips_status_id",render:(e,t)=>{var s,i,l;return a(c,{color:(s=t.pips_status)==null?void 0:s.color,children:(l=(i=t.pips_status)==null?void 0:i.name)==null?void 0:l.toUpperCase()})},align:"center"},{title:"Passed Validation",dataIndex:"passes_validation",key:"passes_validation",align:"center",render:e=>{switch(e){case 1:return a(c,{color:"green",children:"PASSED"});case-1:return a(c,{color:"red",children:"FAILED"});default:return a(c,{color:"geekblue",children:"PENDING"})}}},{title:"Overall Remarks",dataIndex:"remarks",key:"remarks",align:"center",render:(e,t)=>{var s;return(s=t.checklist)==null?void 0:s.overall_remarks}},{title:"PIPOL",dataIndex:"pipol_status",key:"pipol_status_id",render:(e,t)=>{var s,i,l;return a(c,{color:(s=t.pipol_status)==null?void 0:s.color,children:(l=(i=t.pipol_status)==null?void 0:i.name)==null?void 0:l.toUpperCase()})},align:"center"},{title:"Reviewers",dataIndex:"reviewers",key:"reviewers",render:e=>a(f.Group,{children:e.map((t,s)=>a(ce,{user:t,children:a(f,{style:{backgroundColor:t.color},children:t.avatar})},s))}),align:"center"},{title:"Last Updated",dataIndex:"updated_at",key:"updated_at",render:e=>X(e).fromNow(),align:"center"},{title:"Actions",dataIndex:"actions",key:"actions",render:(e,t)=>a(x,{children:a(Y.Button,{overlay:a(Z,{style:{width:150},items:[{label:"Edit",key:1,icon:a(ee,{}),onClick:()=>D(`/pips/${t.uuid}`),disabled:!t.permissions.view},{label:"Drop",key:2,icon:a(te,{}),onClick:()=>B(t),disabled:!t.permissions.drop},{label:"Print",key:3,icon:a(ae,{}),onClick:()=>U(t)},{type:"divider"},{label:"Lock",key:4,icon:a(b,{}),onClick:()=>N(t),disabled:!t.permissions.lock}]})})}),align:"center"}],D=$(),U=e=>{window.open(`/pips/${e.uuid}/print`,{target:"_blank"})},h=async()=>{u(!0);try{const e=await P.get("/tracker",{params:{page:g,q:p}});v(e.data.data),T(e.data.meta.pagination),u(!1)}catch(e){message.error(e.response.data.message),u(!1)}};o.exports.useEffect(()=>{h()},[g,p]);const j=e=>y(e),F=e=>{y(1),A(e)},M=()=>h(),N=e=>{se.confirm({title:"Confirm "+(e.is_locked?"Unlock":"Lock"),icon:e.is_locked?a(ie,{}):a(b,{}),content:e.is_locked?"This will ALLOW users to make modifications to the project. Are you sure you want to continue?":"This will PREVENT users to make modifications to the project. Are you sure you want to continue?",onOk:async()=>{try{const t=await(e.is_locked?w.unlock(e.uuid):w.lock(e.uuid));d.success({title:"Success",message:t.message}),h()}catch(t){d.error({title:"Error",message:t.response.data.message})}}})},[n,q]=o.exports.useState(null),B=e=>{m.resetFields(),q(e),_(!0)},G=async e=>{try{const t=await P.post(`/projects/${n==null?void 0:n.uuid}/drop`,e);d.success({message:C.SUCCESS_MESSAGE,description:t.data.message})}catch(t){d.error({message:C.ERROR_MESSAGE,description:t.response.data.message})}};return r(S,{children:[a(V,{title:r(S,{children:[a(z,{})," Tracker"]}),extra:r(x,{children:[a(de,{onSearch:F,value:p}),a(ue,{onClick:M})]})}),r(ne,{children:[a(K,{rowKey:e=>e.uuid,loading:E,dataSource:I,columns:R,pagination:{...O,position:["bottomCenter"],onChange:j},tableLayout:"fixed",size:"small"}),r(H,{open:L,destroyOnClose:!0,title:"Drop PAP",closable:!0,onClose:()=>_(!1),extra:a(J,{type:"primary",onClick:m.submit,children:"Submit"}),children:[r("h1",{children:["Title: ",n==null?void 0:n.title]}),a(k,{form:m,onFinish:G,initialValues:{remarks:""},layout:"vertical",children:a(k.Item,{label:"Please enter reason for dropping below:",name:"remarks",rules:[{required:!0,message:"This field is required."}],children:a(Q.TextArea,{autoSize:{minRows:3},showCount:!0,maxLength:500,placeholder:"Indicate reason for dropping. This will be included in the notification that will be sent to the office."})})})]})]})]})};export{_e as default};
