import{b as s,a9 as r,j as e,ab as S,e as F,au as O,ai as k,r as n,D as E,S as U,B as b,P as V,aJ as J,n as I,b1 as Q,a8 as Z,F as A,$ as K,C as W,c as X,aZ as Y,a_ as ee,a$ as te,a2 as ae,o as se,aP as ne,m as re,a7 as ie,U as oe,A as v,b2 as le,aj as ce,Q as de}from"./vendor.4b18af18.js";import{d as q,S as ue,g as P,a as D,O as R,e as N,I as me}from"./index.08dd6703.js";import{T as pe}from"./table-search.component.e0d14365.js";import{N as he}from"./new-button.component.3f7c8e4c.js";import{U as T}from"./index.cdd2dec0.js";const M=({form:o,initialValues:d,onFinish:u})=>{const{options:{operating_units:l}}=q();return s(r,{form:o,initialValues:d,onFinish:u,layout:"vertical",children:[e(r.Item,{name:"id",hidden:!0,children:e(S,{})}),s(F,{gutter:16,children:[e(O,{span:8,children:e(r.Item,{label:"Acronym",name:"acronym",rules:[{required:!0}],children:e(S,{})})}),e(O,{span:16,children:e(r.Item,{label:"Name",name:"name",rules:[{required:!0}],children:e(S,{})})})]}),e(r.Item,{label:"Operating Unit",name:"operating_unit_id",rules:[{required:!0}],children:e(ue,{options:l})}),s(F,{gutter:16,children:[e(O,{span:12,children:e(r.Item,{label:"Name of Head",name:"head_name",rules:[{required:!0}],extra:"First Name, Middle Initial, Last Name",children:e(S,{})})}),e(O,{span:12,children:e(r.Item,{label:"Position of Head",name:"head_position",rules:[{required:!0}],children:e(S,{})})})]}),s(F,{gutter:16,children:[e(O,{span:12,children:e(r.Item,{label:"Email",name:"email",rules:[{required:!0}],children:e(S,{})})}),e(O,{span:12,children:e(r.Item,{label:"Phone No.",name:"phone_number",rules:[{required:!0}],children:e(S,{})})})]})]})},$=({title:o,visible:d,onClose:u,office:l,id:c=null})=>{const[i]=r.useForm(),[g,p]=n.exports.useState(!1),[m,f]=n.exports.useState(null),{loadData:y}=P(),x=async h=>{p(!0);try{const C=await(c?D.put(`/offices/${c}`,h):D.post("/offices",h)),{message:w}=C.data;f(w),c||i.resetFields(),p(!1),y()}catch(C){console.error(C),f(C.response.data.message),p(!1)}};return s(E,{title:o,open:d,destroyOnClose:!0,width:{lg:720,sm:378},onClose:u,extra:e(U,{children:e(b,{onClick:i.submit,loading:g,type:"primary",htmlType:"submit",children:"Submit"})}),children:[m&&e(V,{showIcon:!0,type:"success",message:m,style:{marginBottom:"20px"}}),e(M,{form:i,initialValues:l,id:c,onFinish:x})]})};$.propTypes={title:k.exports.string,office:k.exports.object,visible:k.exports.bool,id:k.exports.number,onClose:k.exports.func};const ge=({record:o})=>{const[d]=r.useForm(),[u,l]=n.exports.useState(!1),[c,i]=n.exports.useState(!1),g=async p=>{i(!0);try{const m=await R.put(o.uuid,p);I.success({message:N.SUCCESS_MESSAGE,description:m.message}),i(!1)}catch(m){I.error({message:N.ERROR_MESSAGE,description:m.response.data.message}),i(!1)}};return s(n.exports.Fragment,{children:[e(b,{shape:"circle",icon:e(J,{}),onClick:()=>l(!0)}),e(E,{open:u,closable:!0,onClose:()=>l(!1),extra:e(b,{type:"primary",onClick:d.submit,loading:c,children:"Submit"}),destroyOnClose:!0,children:e(M,{form:d,initialValues:o,onFinish:g})})]})},fe=({record:o})=>{var f,y;const[d,u]=n.exports.useState(!1),[l]=r.useForm(),[c,i]=n.exports.useState(!1),{loadData:g}=P(),{options:{reviewers:p}}=q(),m=async x=>{i(!0);try{const h=await R.assignReviewer(o.uuid,x);g(),I.success({message:"Success!",description:h.message}),i(!1)}catch(h){console.log(h),I.error({message:"Error!",description:h.response.data.message}),i(!1)}};return s(n.exports.Fragment,{children:[e(b,{shape:"circle",icon:e(Q,{}),onClick:()=>u(!0)}),e(E,{open:d,title:`Assign Reviewers: ${o.acronym}`,closable:!0,onClose:()=>u(!1),extra:e(b,{type:"primary",onClick:l.submit,loading:c,children:"Submit"}),children:e(r,{form:l,layout:"vertical",onFinish:m,initialValues:{reviewers:(y=(f=o.reviewers)==null?void 0:f.map(({id:x})=>x))!=null?y:[]},children:e(r.Item,{label:"Reviewers",name:"reviewers",children:e(Z,{options:p,mode:"multiple"})})})})]})},Oe=()=>{const{state:{loading:o,data:d,pagination:u},loadData:l}=P(),[c,i]=n.exports.useState(1),[g,p]=n.exports.useState(10),[m,f]=n.exports.useState(!1),[y,x]=n.exports.useState("");n.exports.useEffect(()=>{w()},[c,y,g]);const h=t=>x(t),C=({current:t,pageSize:a})=>{i(t),p(a)},w=()=>{l(c,y,g)},H=async t=>{try{const a=await R.delete(t);I.success({message:"Success!",description:a.message})}catch(a){I.error({message:"Error!",description:a.response.data.message})}},L=async({uuid:t})=>{de.confirm({title:"Confirm Delete",content:"Are you sure you want to delete this office?",onOk:()=>H(t)})},j=[{title:"Office",dataIndex:"name",key:"name",align:"center",render:(t,a)=>`${a.acronym} \u2014 ${a.name}`},{title:"Head of Office",dataIndex:"head_name",key:"head_name",align:"center"},{title:"Position of Head",dataIndex:"head_position",key:"head_position",align:"center"},{title:"Email",dataIndex:"email",key:"email",align:"center",render:t=>e(se,{title:t,children:e(ne,{onClick:()=>{re.success("Copied email!"),ie(t)}})})},{title:"Contact No.",dataIndex:"phone_number",key:"phone_number",align:"center",responsive:["lg","xl"]},{title:s(A,{children:[e(oe,{})," Users"]}),dataIndex:"users",key:"users",render:t=>e(v.Group,{maxCount:2,children:t==null?void 0:t.map((a,_)=>e(T,{user:a,children:e(v,{style:{backgroundColor:a.color},children:a.avatar})},_))}),align:"center"},{title:s(A,{children:[e(le,{})," Reviewers"]}),dataIndex:"reviewers",key:"reviewers",render:(t,a)=>s(v.Group,{maxCount:2,children:[e(fe,{record:a}),t==null?void 0:t.map((_,G)=>e(T,{user:_,children:e(v,{style:{backgroundColor:_.color},children:_.avatar})},G))]}),align:"center"},{title:"Action",dataIndex:"action",key:"action",align:"center",render:(t,a)=>s(U,{children:[e(ge,{record:a}),e(b,{shape:"circle",icon:e(ce,{}),danger:!0,onClick:()=>L(a)})]})}],[z,B]=n.exports.useState("small");return s(A,{children:[e(K,{title:s("span",{children:[e(W,{})," Offices"]}),extra:s(n.exports.Fragment,{children:[e(pe,{onSearch:h}),e(b,{icon:e(X,{}),onClick:w}),e(he,{onClick:()=>f(!0)}),e(Y,{options:[{value:"small",icon:e(ee,{})},{value:"middle",icon:e(te,{})}],onChange:t=>B(t)})]})}),s(me,{children:[e(ae,{loading:o,dataSource:d,columns:j,pagination:{...u,position:["bottomCenter"]},onChange:C,tableLayout:"fixed",size:z}),e($,{title:"Add Office",office:{operating_unit_id:"",name:"",acronym:"",head_name:"",head_position:"",email:"",phone_number:""},visible:m,onClose:()=>f(!1)})]})]})};export{Oe as default};
