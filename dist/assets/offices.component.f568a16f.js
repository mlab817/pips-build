import{b as s,ab as r,j as e,ad as b,e as F,aw as O,ak as w,r as n,D as E,S as U,B as S,Q as G,aL as Q,n as I,b2 as J,aa as K,F as A,a1 as W,C as X,c as Y,a$ as Z,b0 as ee,b1 as te,a4 as ae,o as se,aS as ne,m as re,a9 as ie,U as oe,A as v,b3 as le,al as ce,V as de}from"./vendor.c9756e39.js";import{d as q,S as ue,g as R,a as P,O as D,e as N,I as me}from"./index.495bcaaa.js";import{T as pe}from"./table-search.component.6c28f8e5.js";import{N as he}from"./new-button.component.3ec819ff.js";import{U as T}from"./index.a5820840.js";const L=({form:o,initialValues:d,onFinish:u})=>{const{options:{operating_units:l}}=q();return s(r,{form:o,initialValues:d,onFinish:u,layout:"vertical",children:[e(r.Item,{name:"id",hidden:!0,children:e(b,{})}),s(F,{gutter:16,children:[e(O,{span:8,children:e(r.Item,{label:"Acronym",name:"acronym",rules:[{required:!0}],children:e(b,{})})}),e(O,{span:16,children:e(r.Item,{label:"Name",name:"name",rules:[{required:!0}],children:e(b,{})})})]}),e(r.Item,{label:"Operating Unit",name:"operating_unit_id",rules:[{required:!0}],children:e(ue,{options:l})}),s(F,{gutter:16,children:[e(O,{span:12,children:e(r.Item,{label:"Name of Head",name:"head_name",rules:[{required:!0}],extra:"First Name, Middle Initial, Last Name",children:e(b,{})})}),e(O,{span:12,children:e(r.Item,{label:"Position of Head",name:"head_position",rules:[{required:!0}],children:e(b,{})})})]}),s(F,{gutter:16,children:[e(O,{span:12,children:e(r.Item,{label:"Email",name:"email",rules:[{required:!0}],children:e(b,{})})}),e(O,{span:12,children:e(r.Item,{label:"Phone No.",name:"phone_number",rules:[{required:!0}],children:e(b,{})})})]})]})},M=({title:o,visible:d,onClose:u,office:l,id:c=null})=>{const[i]=r.useForm(),[g,p]=n.exports.useState(!1),[m,f]=n.exports.useState(null),{loadData:y}=R(),x=async h=>{p(!0);try{const C=await(c?P.put(`/offices/${c}`,h):P.post("/offices",h)),{message:_}=C.data;f(_),c||i.resetFields(),p(!1),y()}catch(C){console.error(C),f(C.response.data.message),p(!1)}};return s(E,{title:o,open:d,destroyOnClose:!0,width:{lg:720,sm:378},onClose:u,extra:e(U,{children:e(S,{onClick:i.submit,loading:g,type:"primary",htmlType:"submit",children:"Submit"})}),children:[m&&e(G,{showIcon:!0,type:"success",message:m,style:{marginBottom:"20px"}}),e(L,{form:i,initialValues:l,id:c,onFinish:x})]})};M.propTypes={title:w.exports.string,office:w.exports.object,visible:w.exports.bool,id:w.exports.number,onClose:w.exports.func};const ge=({record:o})=>{const[d]=r.useForm(),[u,l]=n.exports.useState(!1),[c,i]=n.exports.useState(!1),g=async p=>{i(!0);try{const m=await D.put(o.uuid,p);I.success({message:N.SUCCESS_MESSAGE,description:m.message}),i(!1)}catch(m){I.error({message:N.ERROR_MESSAGE,description:m.response.data.message}),i(!1)}};return s(n.exports.Fragment,{children:[e(S,{shape:"circle",icon:e(Q,{}),onClick:()=>l(!0)}),e(E,{open:u,closable:!0,onClose:()=>l(!1),extra:e(S,{type:"primary",onClick:d.submit,loading:c,children:"Submit"}),destroyOnClose:!0,children:e(L,{form:d,initialValues:o,onFinish:g})})]})},fe=({record:o})=>{var f,y;const[d,u]=n.exports.useState(!1),[l]=r.useForm(),[c,i]=n.exports.useState(!1),{loadData:g}=R(),{options:{reviewers:p}}=q(),m=async x=>{i(!0);try{const h=await D.assignReviewer(o.uuid,x);g(),I.success({message:"Success!",description:h.message}),i(!1)}catch(h){console.log(h),I.error({message:"Error!",description:h.response.data.message}),i(!1)}};return s(n.exports.Fragment,{children:[e(S,{shape:"circle",icon:e(J,{}),onClick:()=>u(!0)}),e(E,{open:d,title:`Assign Reviewers: ${o.acronym}`,closable:!0,onClose:()=>u(!1),extra:e(S,{type:"primary",onClick:l.submit,loading:c,children:"Submit"}),children:e(r,{form:l,layout:"vertical",onFinish:m,initialValues:{reviewers:(y=(f=o.reviewers)==null?void 0:f.map(({id:x})=>x))!=null?y:[]},children:e(r.Item,{label:"Reviewers",name:"reviewers",children:e(K,{options:p,mode:"multiple"})})})})]})},Oe=()=>{const{state:{loading:o,data:d,pagination:u},loadData:l}=R(),[c,i]=n.exports.useState(1),[g,p]=n.exports.useState(10),[m,f]=n.exports.useState(!1),[y,x]=n.exports.useState("");n.exports.useEffect(()=>{_()},[c,y,g]);const h=t=>x(t),C=({current:t,pageSize:a})=>{i(t),p(a)},_=()=>{l(c,y,g)},H=async t=>{try{const a=await D.delete(t);I.success({message:"Success!",description:a.message})}catch(a){I.error({message:"Error!",description:a.response.data.message})}},$=async({uuid:t})=>{de.confirm({title:"Confirm Delete",content:"Are you sure you want to delete this office?",onOk:()=>H(t)})},z=[{title:"Office",dataIndex:"name",key:"name",align:"center",render:(t,a)=>`${a.acronym} \u2014 ${a.name}`},{title:"Head of Office",dataIndex:"head_name",key:"head_name",align:"center"},{title:"Position of Head",dataIndex:"head_position",key:"head_position",align:"center"},{title:"Email",dataIndex:"email",key:"email",align:"center",render:t=>e(se,{title:t,children:e(ne,{onClick:()=>{re.success("Copied email!"),ie(t)}})})},{title:"Contact No.",dataIndex:"phone_number",key:"phone_number",align:"center",responsive:["lg","xl"]},{title:s(A,{children:[e(oe,{})," Users"]}),dataIndex:"users",key:"users",render:t=>e(v.Group,{maxCount:2,children:t==null?void 0:t.map((a,k)=>e(T,{user:a,children:e(v,{style:{backgroundColor:a.color},children:a.avatar})},k))}),align:"center"},{title:s(A,{children:[e(le,{})," Reviewers"]}),dataIndex:"reviewers",key:"reviewers",render:(t,a)=>s(v.Group,{maxCount:2,children:[e(fe,{record:a}),t==null?void 0:t.map((k,B)=>e(T,{user:k,children:e(v,{style:{backgroundColor:k.color},children:k.avatar})},B))]}),align:"center"},{title:"Action",dataIndex:"action",key:"action",align:"center",render:(t,a)=>s(U,{children:[e(ge,{record:a}),e(S,{shape:"circle",icon:e(ce,{}),danger:!0,onClick:()=>$(a)})]})}],[V,j]=n.exports.useState("small");return s(A,{children:[e(W,{title:s("span",{children:[e(X,{})," Offices"]}),extra:s(n.exports.Fragment,{children:[e(pe,{onSearch:h}),e(S,{icon:e(Y,{}),onClick:_}),e(he,{onClick:()=>f(!0)}),e(Z,{options:[{value:"small",icon:e(ee,{})},{value:"middle",icon:e(te,{})}],onChange:t=>j(t)})]})}),s(me,{children:[e(ae,{loading:o,dataSource:d,columns:z,pagination:{...u,position:["bottomCenter"]},onChange:C,tableLayout:"fixed",size:V}),e(M,{title:"Add Office",office:{operating_unit_id:"",name:"",acronym:"",head_name:"",head_position:"",email:"",phone_number:""},visible:m,onClose:()=>f(!1)})]})]})};export{Oe as default};
