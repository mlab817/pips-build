import{r as o,a5 as k,u as V,b as r,F as S,j as a,X as $,v as z,S as x,_ as J,D as K,B as H,a7 as W,A as f,a0 as X,aJ as c,h as Q,o as Y,M as Z,aK as ee,aL as te,aM as ae,aN as P,J as se,aO as ie,n as d}from "./vendor.b3bf9397.js";import{b as oe,I as ne,C as re,a as b,P as w,e as C}from "./index.e5fa85cd.js";import{O as le}from "./index.3f605551.js";import{U as ce}from "./index.e1812f31.js";import{T as de}from "./table-search.component.d892e67b.js";import{R as ue}from "./download-button.component.0665ee37.js";import"./new-button.component.d06ba8e7.js";const _e=()=>{const[I,v]=o.exports.useState([]),[O,T]=o.exports.useState({}),[g,y]=o.exports.useState(1),[E,u]=o.exports.useState(!1),[p,A]=o.exports.useState(""),[L,_]=o.exports.useState(!1),[m]=k.useForm();oe();const R=[{title:"Project Title",dataIndex:"title",key:"title"},{title:"Office",dataIndex:"office",key:"office_id",render:(e, t)=>{var s,i;return a(le,{office:t.office,children:a(f,{style:{backgroundColor:(s=t.office)==null?void 0:s.color},children:(i=t.office)==null?void 0:i.acronym})})},align:"center"},{title:"Issues",dataIndex:"issues_count",key:"issues_count",align:"center",render:(e, t)=>t.issues_count>0?t.issues_count:a(X,{style:{color:re.green}})},{title:"PIPS",dataIndex:"pips_status",key:"pips_status_id",render:(e, t)=>{var s,i,l;return a(c,{color:(s=t.pips_status)==null?void 0:s.color,children:(l=(i=t.pips_status)==null?void 0:i.name)==null?void 0:l.toUpperCase()})},align:"center"},{title:"Passed Validation",dataIndex:"passes_validation",key:"passes_validation",align:"center",render: e=>{switch(e){case 1:return a(c,{color:"green",children:"PASSED"});case-1:return a(c,{color:"red",children:"FAILED"});default:return a(c,{color:"geekblue",children:"PENDING"})}}},{title:"Overall Remarks",dataIndex:"remarks",key:"remarks",align:"center",render:(e, t)=>{var s;return(s=t.checklist)==null?void 0:s.overall_remarks}},{title:"PIPOL",dataIndex:"pipol_status",key:"pipol_status_id",render:(e, t)=>{var s,i,l;return a(c,{color:(s=t.pipol_status)==null?void 0:s.color,children:(l=(i=t.pipol_status)==null?void 0:i.name)==null?void 0:l.toUpperCase()})},align:"center"},{title:"Reviewers",dataIndex:"reviewers",key:"reviewers",render: e=>a(f.Group,{children:e.map((t, s)=>a(ce,{user:t,children:a(f,{style:{backgroundColor:t.color},children:t.avatar})},s))}),align:"center"},{title:"Last Updated",dataIndex:"updated_at",key:"updated_at",render: e=>Q(e).fromNow(),align:"center"},{title:"Actions",dataIndex:"actions",key:"actions",render:(e, t)=>a(x,{children:a(Y.Button,{overlay:a(Z,{style:{width:150},items:[{label:"Edit",key:1,icon:a(ee,{}),onClick:()=>D(`/pips/${t.uuid}`),disabled:!t.permissions.view},{label:"Drop",key:2,icon:a(te,{}),onClick:()=>G(t),disabled:!t.permissions.drop},{label:"Print",key:3,icon:a(ae,{}),onClick:()=>U(t)},{type:"divider"},{label:"Lock",key:4,icon:a(P,{}),onClick:()=>N(t),disabled:!t.permissions.lock}]})})}),align:"center"}],D=V(),U= e=>{window.open(`/pips/${e.uuid}/print`,{target:"_blank"})},h=async()=>{u(!0);try{const e=await b.get("/tracker",{params:{page:g,q:p}});v(e.data.data),T(e.data.meta.pagination),u(!1)}catch(e){message.error(e.response.data.message),u(!1)}};o.exports.useEffect(()=>{h()},[g,p]);const j= e=>y(e),F= e=>{y(1),A(e)},M=()=>h(),N= e=>{se.confirm({title:"Confirm "+(e.is_locked?"Unlock":"Lock"),icon:e.is_locked?a(ie,{}):a(P,{}),content:e.is_locked?"This will ALLOW users to make modifications to the project. Are you sure you want to continue?":"This will PREVENT users to make modifications to the project. Are you sure you want to continue?",onOk:async()=>{try{const t=await(e.is_locked?w.unlock(e.uuid):w.lock(e.uuid));d.success({title:"Success",message:t.message}),h()}catch(t){d.error({title:"Error",message:t.response.data.message})}}})},[n,B]=o.exports.useState(null),G= e=>{m.resetFields(),B(e),_(!0)},q=async e=>{try{const t=await b.post(`/projects/${n==null?void 0:n.uuid}/drop`,e);d.success({message:C.SUCCESS_MESSAGE,description:t.data.message})}catch(t){d.error({message:C.ERROR_MESSAGE,description:t.response.data.message})}};return r(S,{children:[a($,{title:r(S,{children:[a(z,{})," Tracker"]}),extra:r(x,{children:[a(de,{onSearch:F,value:p}),a(ue,{onClick:M})]})}),r(ne,{children:[a(J,{rowKey: e=>e.uuid,loading:E,dataSource:I,columns:R,pagination:{...O,position:["bottomCenter"],onChange:j},tableLayout:"fixed",size:"small"}),r(K,{open:L,destroyOnClose:!0,title:"Drop PAP",closable:!0,onClose:()=>_(!1),extra:a(H,{type:"primary",onClick:m.submit,children:"Submit"}),children:[r("h1",{children:["Title: ",n==null?void 0:n.title]}),a(k,{form:m,onFinish:q,initialValues:{remarks:""},layout:"vertical",children:a(k.Item,{label:"Please enter reason for dropping below:",name:"remarks",rules:[{required:!0,message:"This field is required."}],children:a(W.TextArea,{autoSize:{minRows:3},showCount:!0,maxLength:500,placeholder:"Indicate reason for dropping. This will be included in the notification that will be sent to the office."})})})]})]})]})};export{_e as default};
